
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Scene &#8212; mjlab Documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/twemoji.css" />
    <link rel="stylesheet" type="text/css" href="/home/runner/work/mjlab/mjlab/.venv/lib/python3.13/site-packages/sphinxcontrib/icon/node_modules/@fortawesome/fontawesome-free/css/all.min.css?v=53359634" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=3ea80bc3" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="https://unpkg.com/twemoji@latest/dist/twemoji.min.js"></script>
    <script src="../_static/twemoji.js"></script>
    <script src="/home/runner/work/mjlab/mjlab/.venv/lib/python3.13/site-packages/sphinxcontrib/icon/node_modules/@fortawesome/fontawesome-free/js/all.min.js?v=ec35c6c9"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'source/scene';</script>
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Terrain" href="terrain.html" />
    <link rel="prev" title="RGB-D Camera" href="sensors/rgbd_camera.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
    <meta name="docbuild:last-update" content="Feb 25, 2026"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">mjlab Documentation</p>
  
</a></div>
        <div class="sidebar-primary-item">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
        <div class="sidebar-primary-item">
<div class="sidebar-version-switcher">
  <label class="sidebar-version-label" for="version-select">Version</label>
  <select id="version-select" class="sidebar-version-select" onchange="location = this.value;">
    <option value="scene.html" selected>main</option>
  </select>
</div>
</div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Concepts</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="architecture_overview.html">Architecture Overview</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="entity/index.html">Entity</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="entity/entity_data.html">Entity Data</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="actuators.html">Actuators</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="sensors/index.html">Sensors</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="sensors/raycast_sensor.html">RayCast Sensor</a></li>
<li class="toctree-l2"><a class="reference internal" href="sensors/rgbd_camera.html">RGB-D Camera</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Scene</a></li>
<li class="toctree-l1"><a class="reference internal" href="terrain.html">Terrain</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">The Manager Layer</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="environment_config.html">Environment Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="observations.html">Observations</a></li>
<li class="toctree-l1"><a class="reference internal" href="actions.html">Actions</a></li>
<li class="toctree-l1"><a class="reference internal" href="rewards.html">Rewards</a></li>
<li class="toctree-l1"><a class="reference internal" href="terminations.html">Terminations</a></li>
<li class="toctree-l1"><a class="reference internal" href="commands.html">Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="events.html">Events</a></li>
<li class="toctree-l1"><a class="reference internal" href="randomization.html">Domain Randomization</a></li>
<li class="toctree-l1"><a class="reference internal" href="curriculum.html">Curriculum</a></li>
<li class="toctree-l1"><a class="reference internal" href="metrics.html">Metrics</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Training &amp; Debugging</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="training/rsl_rl.html">Training with RSL-RL</a></li>
<li class="toctree-l1"><a class="reference internal" href="viewers.html">Viewers</a></li>
<li class="toctree-l1"><a class="reference internal" href="training/distributed_training.html">Distributed Training</a></li>
<li class="toctree-l1"><a class="reference internal" href="training/cloud.html">Cloud Training</a></li>
<li class="toctree-l1"><a class="reference internal" href="debugging/nan_guard.html">NaN Guard</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="api/index.html">API Reference</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="api/envs.html">mjlab.envs</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/scene.html">mjlab.scene</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/sim.html">mjlab.sim</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/entity.html">mjlab.entity</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/actuator.html">mjlab.actuator</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/sensor.html">mjlab.sensor</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/managers.html">mjlab.managers</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/terrains.html">mjlab.terrains</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/rl.html">mjlab.rl</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/viewer.html">mjlab.viewer</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/tasks.html">mjlab.tasks</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Further Reading</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="motivation.html">Why mjlab?</a></li>
<li class="toctree-l1"><a class="reference internal" href="migration_isaac_lab.html">Migrating from Isaac Lab</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ &amp; Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/mujocolab/mjlab" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/mujocolab/mjlab/edit/main/docs/source/scene.rst" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/mujocolab/mjlab/issues/new?title=Issue%20on%20page%20%2Fsource/scene.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/source/scene.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Scene</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#composition">Composition</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#environment-origins">Environment origins</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#custom-spec-editing">Custom spec editing</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="scene">
<span id="id1"></span><h1>Scene<a class="headerlink" href="#scene" title="Link to this heading">#</a></h1>
<p>The scene merges entities, terrain, and sensors into a single
simulation. <code class="docutils literal notranslate"><span class="pre">SceneCfg</span></code> describes the contents of the world, and the
<code class="docutils literal notranslate"><span class="pre">Scene</span></code> class handles MJCF composition, compilation, and runtime
state management.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">mjlab.scene</span><span class="w"> </span><span class="kn">import</span> <span class="n">SceneCfg</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mjlab.terrains</span><span class="w"> </span><span class="kn">import</span> <span class="n">TerrainEntityCfg</span>

<span class="c1"># A robot on a flat ground plane with 4096 parallel environments.</span>
<span class="n">scene_cfg</span> <span class="o">=</span> <span class="n">SceneCfg</span><span class="p">(</span>
    <span class="n">num_envs</span><span class="o">=</span><span class="mi">4096</span><span class="p">,</span>
    <span class="n">env_spacing</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span>
    <span class="n">terrain</span><span class="o">=</span><span class="n">TerrainEntityCfg</span><span class="p">(</span><span class="n">terrain_type</span><span class="o">=</span><span class="s2">&quot;plane&quot;</span><span class="p">),</span>
    <span class="n">entities</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;robot&quot;</span><span class="p">:</span> <span class="n">robot_cfg</span><span class="p">},</span>
<span class="p">)</span>
</pre></div>
</div>
<p>A scene with procedural terrain, sensors, and multiple entities:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">mjlab.scene</span><span class="w"> </span><span class="kn">import</span> <span class="n">SceneCfg</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mjlab.terrains</span><span class="w"> </span><span class="kn">import</span> <span class="n">TerrainEntityCfg</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mjlab.terrains.config</span><span class="w"> </span><span class="kn">import</span> <span class="n">ROUGH_TERRAINS_CFG</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mjlab.sensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">RayCastSensorCfg</span><span class="p">,</span> <span class="n">ContactSensorCfg</span>

<span class="n">scene_cfg</span> <span class="o">=</span> <span class="n">SceneCfg</span><span class="p">(</span>
    <span class="n">num_envs</span><span class="o">=</span><span class="mi">4096</span><span class="p">,</span>
    <span class="n">terrain</span><span class="o">=</span><span class="n">TerrainEntityCfg</span><span class="p">(</span>
        <span class="n">terrain_type</span><span class="o">=</span><span class="s2">&quot;generator&quot;</span><span class="p">,</span>
        <span class="n">terrain_generator</span><span class="o">=</span><span class="n">ROUGH_TERRAINS_CFG</span><span class="p">,</span>
        <span class="n">max_init_terrain_level</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">entities</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;robot&quot;</span><span class="p">:</span> <span class="n">robot_cfg</span><span class="p">,</span>
        <span class="s2">&quot;cube&quot;</span><span class="p">:</span> <span class="n">cube_cfg</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="n">sensors</span><span class="o">=</span><span class="p">(</span>
        <span class="n">RayCastSensorCfg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;terrain_scan&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">),</span>
        <span class="n">ContactSensorCfg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;feet_contact&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">),</span>
    <span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
<section id="composition">
<h2>Composition<a class="headerlink" href="#composition" title="Link to this heading">#</a></h2>
<p>The scene starts from a root <code class="docutils literal notranslate"><span class="pre">MjSpec</span></code> and
<a class="reference external" href="https://mujoco.readthedocs.io/en/stable/python.html#attachment">attaches</a>
each entity’s spec into it with a unique name prefix. A robot entity named <code class="docutils literal notranslate"><span class="pre">&quot;robot&quot;</span></code> has all its
internal MuJoCo elements (bodies, joints, geoms, actuators, sensors)
prefixed with <code class="docutils literal notranslate"><span class="pre">robot/</span></code>, so <code class="docutils literal notranslate"><span class="pre">base_link</span></code> becomes <code class="docutils literal notranslate"><span class="pre">robot/base_link</span></code>,
<code class="docutils literal notranslate"><span class="pre">joint0</span></code> becomes <code class="docutils literal notranslate"><span class="pre">robot/joint0</span></code>, and so on. Prefixing prevents name
collisions when multiple entities share element names and provides a
consistent namespace for observation and reward terms.</p>
<p>Terrain, when present, is attached without a prefix (its elements live
in the global namespace). Sensors are added after entities and can
reference entity elements by their prefixed names.</p>
<p><code class="docutils literal notranslate"><span class="pre">scene.compile()</span></code> converts the composed <code class="docutils literal notranslate"><span class="pre">MjSpec</span></code> into a single
<code class="docutils literal notranslate"><span class="pre">MjModel</span></code>. The <code class="docutils literal notranslate"><span class="pre">Simulation</span></code> class then uploads this model to the
GPU via MuJoCo Warp. After the simulation is created,
<code class="docutils literal notranslate"><span class="pre">scene.initialize()</span></code> resolves each entity’s element indices into the
compiled model, allocates state buffers, and sets up GPU rendering
resources for any camera or raycast sensors.</p>
<p><code class="docutils literal notranslate"><span class="pre">scene.to_zip(path)</span></code> exports the compiled model as a <code class="docutils literal notranslate"><span class="pre">.zip</span></code> file
for offline inspection in the standalone MuJoCo viewer. Each entity’s
initial state keyframe is merged into the export, so the model opens
in its default pose.</p>
<p>At runtime, entities and sensors are accessible by name:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">robot</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">scene</span><span class="p">[</span><span class="s2">&quot;robot&quot;</span><span class="p">]</span>              <span class="c1"># Entity</span>
<span class="n">scan</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">scene</span><span class="p">[</span><span class="s2">&quot;terrain_scan&quot;</span><span class="p">]</span>        <span class="c1"># Sensor</span>
<span class="n">contact</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">scene</span><span class="p">[</span><span class="s2">&quot;feet_contact&quot;</span><span class="p">]</span>     <span class="c1"># Sensor</span>

<span class="n">robot</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">joint_pos</span>                    <span class="c1"># [B, num_joints]</span>
<span class="n">scan</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">distances</span>                     <span class="c1"># [B, N]</span>
<span class="n">contact</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">force</span>                      <span class="c1"># [B, N, 3]</span>
</pre></div>
</div>
<p>Builtin sensors defined in an entity’s XML are auto-discovered during
composition and accessible with the entity name prefix:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">imu</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">scene</span><span class="p">[</span><span class="s2">&quot;robot/trunk_imu&quot;</span><span class="p">]</span>      <span class="c1"># Auto-discovered sensor</span>
</pre></div>
</div>
</section>
<section id="environment-origins">
<h2>Environment origins<a class="headerlink" href="#environment-origins" title="Link to this heading">#</a></h2>
<p>Each environment in MuJoCo Warp is an independent world with its own
state. Environments do not share physical space and cannot interact with
each other. Environment origins exist for two purposes: spreading
entities across the world for visualization (so the viewer shows robots
side by side rather than stacked at the origin), and for locomotion
tasks with procedural terrain, placing each environment at a specific
sub-terrain patch.</p>
<p><strong>Flat terrain.</strong> Origins form a regular grid centered at the world
origin with <code class="docutils literal notranslate"><span class="pre">env_spacing</span></code> meters between neighbors.</p>
<p><strong>Procedural terrain.</strong> The terrain generator produces a
<code class="docutils literal notranslate"><span class="pre">num_rows</span> <span class="pre">x</span> <span class="pre">num_cols</span></code> grid of sub-terrain patches, each with its own
center point. Each environment is assigned to one patch, and the
terrain curriculum system moves environments to harder patches as
performance improves. See <a class="reference internal" href="terrain.html#terrain"><span class="std std-ref">Terrain</span></a> for details.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All environments currently share the same <code class="docutils literal notranslate"><span class="pre">MjModel</span></code> (identical
meshes, geometries, and kinematic trees). Heterogeneous simulation,
where different worlds can have different meshes or geometries, is
<a class="reference external" href="https://github.com/google-deepmind/mujoco_warp/pull/1009">in progress in MuJoCo Warp</a>.
mjlab will support this once it lands upstream.</p>
</div>
<p>Reset event terms read <code class="docutils literal notranslate"><span class="pre">scene.env_origins</span></code> to position entities:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Inside a reset event term.</span>
<span class="n">robot</span><span class="o">.</span><span class="n">write_root_pose_to_sim</span><span class="p">(</span>
    <span class="n">default_root_pose</span> <span class="o">+</span> <span class="n">env_origins</span><span class="p">[</span><span class="n">env_ids</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Each origin is marked with an invisible sphere site (geom group 4) that
appears in the MuJoCo viewer when group 4 is enabled, useful for
verifying placement during development.</p>
</section>
<section id="custom-spec-editing">
<h2>Custom spec editing<a class="headerlink" href="#custom-spec-editing" title="Link to this heading">#</a></h2>
<p>Most scenes are fully described by their entities, terrain, and sensors.
Occasionally a modification spans multiple entities. A tendon connecting
a ceiling gantry to the robot, for example, cannot be defined inside
either entity’s MJCF because it references sites from both.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">spec_fn</span></code> callback on <code class="docutils literal notranslate"><span class="pre">SceneCfg</span></code> handles this case. It receives
the fully composed <code class="docutils literal notranslate"><span class="pre">MjSpec</span></code> after all entities and sensors have been
attached with their prefixed names, but before compilation:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">mujoco</span>

<span class="k">def</span><span class="w"> </span><span class="nf">add_gantry</span><span class="p">(</span><span class="n">spec</span><span class="p">:</span> <span class="n">mujoco</span><span class="o">.</span><span class="n">MjSpec</span><span class="p">):</span>
    <span class="n">spec</span><span class="o">.</span><span class="n">worldbody</span><span class="o">.</span><span class="n">add_site</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;gantry&quot;</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">side</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="s2">&quot;right&quot;</span><span class="p">]:</span>
        <span class="n">tendon</span> <span class="o">=</span> <span class="n">spec</span><span class="o">.</span><span class="n">add_tendon</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">side</span><span class="si">}</span><span class="s2">_rope&quot;</span><span class="p">,</span>
            <span class="n">limited</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">tendon</span><span class="o">.</span><span class="n">wrap_site</span><span class="p">(</span><span class="s2">&quot;gantry&quot;</span><span class="p">)</span>
        <span class="n">tendon</span><span class="o">.</span><span class="n">wrap_site</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;robot/</span><span class="si">{</span><span class="n">side</span><span class="si">}</span><span class="s2">_hook&quot;</span><span class="p">)</span>

<span class="n">scene_cfg</span> <span class="o">=</span> <span class="n">SceneCfg</span><span class="p">(</span>
    <span class="n">entities</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;robot&quot;</span><span class="p">:</span> <span class="n">robot_cfg</span><span class="p">},</span>
    <span class="n">spec_fn</span><span class="o">=</span><span class="n">add_gantry</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Other common uses include global equality constraints, custom
visualization geometry, and any modification that requires access to the
fully composed scene.</p>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="sensors/rgbd_camera.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">RGB-D Camera</p>
      </div>
    </a>
    <a class="right-next"
       href="terrain.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Terrain</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#composition">Composition</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#environment-origins">Environment origins</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#custom-spec-editing">Custom spec editing</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The mjlab Developers
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025, The mjlab Developers.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    <p class="last-updated">
  Last updated on Feb 25, 2026.
  <br/>
</p>
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>