
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Environment Configuration &#8212; mjlab Documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/twemoji.css" />
    <link rel="stylesheet" type="text/css" href="/home/runner/work/mjlab/mjlab/.venv/lib/python3.13/site-packages/sphinxcontrib/icon/node_modules/@fortawesome/fontawesome-free/css/all.min.css?v=53359634" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=3ea80bc3" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="https://unpkg.com/twemoji@latest/dist/twemoji.min.js"></script>
    <script src="../_static/twemoji.js"></script>
    <script src="/home/runner/work/mjlab/mjlab/.venv/lib/python3.13/site-packages/sphinxcontrib/icon/node_modules/@fortawesome/fontawesome-free/js/all.min.js?v=ec35c6c9"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'source/environment_config';</script>
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Observations" href="observations.html" />
    <link rel="prev" title="Terrain" href="terrain.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
    <meta name="docbuild:last-update" content="Feb 25, 2026"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">mjlab Documentation</p>
  
</a></div>
        <div class="sidebar-primary-item">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
        <div class="sidebar-primary-item">
<div class="sidebar-version-switcher">
  <label class="sidebar-version-label" for="version-select">Version</label>
  <select id="version-select" class="sidebar-version-select" onchange="location = this.value;">
    <option value="environment_config.html" selected>main</option>
  </select>
</div>
</div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Concepts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="architecture_overview.html">Architecture Overview</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="entity/index.html">Entity</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="entity/entity_data.html">Entity Data</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="actuators.html">Actuators</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="sensors/index.html">Sensors</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="sensors/raycast_sensor.html">RayCast Sensor</a></li>
<li class="toctree-l2"><a class="reference internal" href="sensors/rgbd_camera.html">RGB-D Camera</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="scene.html">Scene</a></li>
<li class="toctree-l1"><a class="reference internal" href="terrain.html">Terrain</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">The Manager Layer</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Environment Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="observations.html">Observations</a></li>
<li class="toctree-l1"><a class="reference internal" href="actions.html">Actions</a></li>
<li class="toctree-l1"><a class="reference internal" href="rewards.html">Rewards</a></li>
<li class="toctree-l1"><a class="reference internal" href="terminations.html">Terminations</a></li>
<li class="toctree-l1"><a class="reference internal" href="commands.html">Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="events.html">Events</a></li>
<li class="toctree-l1"><a class="reference internal" href="randomization.html">Domain Randomization</a></li>
<li class="toctree-l1"><a class="reference internal" href="curriculum.html">Curriculum</a></li>
<li class="toctree-l1"><a class="reference internal" href="metrics.html">Metrics</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Training &amp; Debugging</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="training/rsl_rl.html">Training with RSL-RL</a></li>
<li class="toctree-l1"><a class="reference internal" href="viewers.html">Viewers</a></li>
<li class="toctree-l1"><a class="reference internal" href="training/distributed_training.html">Distributed Training</a></li>
<li class="toctree-l1"><a class="reference internal" href="training/cloud.html">Cloud Training</a></li>
<li class="toctree-l1"><a class="reference internal" href="debugging/nan_guard.html">NaN Guard</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="api/index.html">API Reference</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="api/envs.html">mjlab.envs</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/scene.html">mjlab.scene</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/sim.html">mjlab.sim</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/entity.html">mjlab.entity</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/actuator.html">mjlab.actuator</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/sensor.html">mjlab.sensor</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/managers.html">mjlab.managers</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/terrains.html">mjlab.terrains</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/rl.html">mjlab.rl</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/viewer.html">mjlab.viewer</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/tasks.html">mjlab.tasks</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Further Reading</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="motivation.html">Why mjlab?</a></li>
<li class="toctree-l1"><a class="reference internal" href="migration_isaac_lab.html">Migrating from Isaac Lab</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ &amp; Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/mujocolab/mjlab" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/mujocolab/mjlab/edit/main/docs/source/environment_config.rst" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/mujocolab/mjlab/issues/new?title=Issue%20on%20page%20%2Fsource/environment_config.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/source/environment_config.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Environment Configuration</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#annotated-skeleton">Annotated skeleton</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#term-configuration-pattern">Term configuration pattern</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#timing-decimation-timestep-and-episode-length">Timing: decimation, timestep, and episode length</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#subclassing-pattern">Subclassing pattern</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#where-to-go-next">Where to go next</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="environment-configuration">
<span id="environment-config"></span><h1>Environment Configuration<a class="headerlink" href="#environment-configuration" title="Link to this heading">#</a></h1>
<p>A single <code class="docutils literal notranslate"><span class="pre">ManagerBasedRlEnvCfg</span></code> dataclass fully specifies an mjlab
environment: the physical world, the agent’s interface to it, and the
MDP defined on top. Because everything lives in one flat
object, an environment can be inspected, copied, and modified without
navigating a class hierarchy.</p>
<p>For a broad orientation to mjlab before reading this page, start with
<a class="reference internal" href="architecture_overview.html#architecture-overview"><span class="std std-ref">Architecture Overview</span></a>.</p>
<section id="annotated-skeleton">
<span id="env-config-skeleton"></span><h2>Annotated skeleton<a class="headerlink" href="#annotated-skeleton" title="Link to this heading">#</a></h2>
<p>The complete set of fields on <code class="docutils literal notranslate"><span class="pre">ManagerBasedRlEnvCfg</span></code> is shown below with
inline comments. The fields marked with <code class="docutils literal notranslate"><span class="pre">...</span></code> must be provided; all others
have defaults.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span><span class="p">,</span> <span class="n">field</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">mjlab.envs</span><span class="w"> </span><span class="kn">import</span> <span class="n">ManagerBasedRlEnvCfg</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mjlab.managers.action_manager</span><span class="w"> </span><span class="kn">import</span> <span class="n">ActionTermCfg</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mjlab.managers.command_manager</span><span class="w"> </span><span class="kn">import</span> <span class="n">CommandTermCfg</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mjlab.managers.curriculum_manager</span><span class="w"> </span><span class="kn">import</span> <span class="n">CurriculumTermCfg</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mjlab.managers.event_manager</span><span class="w"> </span><span class="kn">import</span> <span class="n">EventTermCfg</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mjlab.managers.metrics_manager</span><span class="w"> </span><span class="kn">import</span> <span class="n">MetricsTermCfg</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mjlab.managers.observation_manager</span><span class="w"> </span><span class="kn">import</span> <span class="n">ObservationGroupCfg</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mjlab.managers.reward_manager</span><span class="w"> </span><span class="kn">import</span> <span class="n">RewardTermCfg</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mjlab.managers.termination_manager</span><span class="w"> </span><span class="kn">import</span> <span class="n">TerminationTermCfg</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mjlab.scene.scene</span><span class="w"> </span><span class="kn">import</span> <span class="n">SceneCfg</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mjlab.sim.sim</span><span class="w"> </span><span class="kn">import</span> <span class="n">SimulationCfg</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mjlab.viewer.viewer_config</span><span class="w"> </span><span class="kn">import</span> <span class="n">ViewerConfig</span>


<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">MyEnvCfg</span><span class="p">(</span><span class="n">ManagerBasedRlEnvCfg</span><span class="p">):</span>

    <span class="c1"># --- Physics ---</span>

    <span class="n">decimation</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="c1"># Number of physics steps per policy step.</span>
    <span class="c1"># Environment step duration = sim.mujoco.timestep * decimation.</span>

    <span class="n">sim</span><span class="p">:</span> <span class="n">SimulationCfg</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">SimulationCfg</span><span class="p">)</span>
    <span class="c1"># Physics parameters: timestep, integrator, solver, contact settings.</span>
    <span class="c1"># Default timestep is 0.002 s (500 Hz). Override with MujocoCfg.</span>

    <span class="n">scene</span><span class="p">:</span> <span class="n">SceneCfg</span> <span class="o">=</span> <span class="o">...</span>
    <span class="c1"># Terrain, entities, and sensors. Also sets num_envs.</span>
    <span class="c1"># Required; there is no default.</span>

    <span class="c1"># --- Episode ---</span>

    <span class="n">episode_length_s</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">20.0</span>
    <span class="c1"># Episode duration in seconds.</span>
    <span class="c1"># Steps = ceil(episode_length_s / (sim.mujoco.timestep * decimation)).</span>

    <span class="n">is_finite_horizon</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="c1"># False (default): time limit is an artificial cutoff. The agent</span>
    <span class="c1">#   receives a truncated signal and bootstraps value beyond the limit.</span>
    <span class="c1"># True: time limit defines the task boundary. The agent receives a</span>
    <span class="c1">#   terminal done signal with no future value beyond it.</span>

    <span class="n">scale_rewards_by_dt</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="c1"># When True (default), each reward term is multiplied by step_dt so</span>
    <span class="c1"># that cumulative episodic sums are invariant to simulation frequency.</span>
    <span class="c1"># Set to False for algorithms that expect unscaled reward signals.</span>

    <span class="c1"># --- Managers ---</span>

    <span class="n">observations</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ObservationGroupCfg</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
    <span class="c1"># Observation groups. Each key is a group name (e.g. &quot;actor&quot;, &quot;critic&quot;).</span>
    <span class="c1"># Groups can differ in noise, history, delay, and concatenation.</span>

    <span class="n">actions</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ActionTermCfg</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
    <span class="c1"># Action terms. Each term controls one slice of the policy output</span>
    <span class="c1"># and routes it to a specific entity&#39;s actuators.</span>

    <span class="n">rewards</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">RewardTermCfg</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
    <span class="c1"># Reward terms. The manager computes a weighted sum each step.</span>

    <span class="n">terminations</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">TerminationTermCfg</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
    <span class="c1"># Termination conditions. If empty, episodes never terminate early.</span>
    <span class="c1"># Add a time_out term to enforce the episode length limit.</span>

    <span class="n">events</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">EventTermCfg</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;reset_scene_to_default&quot;</span><span class="p">:</span> <span class="n">EventTermCfg</span><span class="p">(</span>
                <span class="n">func</span><span class="o">=</span><span class="n">reset_scene_to_default</span><span class="p">,</span>
                <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;reset&quot;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="c1"># Event terms for domain randomization and state resets.</span>
    <span class="c1"># The default includes reset_scene_to_default, which resets all</span>
    <span class="c1"># entities to their initial pose each episode. Override this dict</span>
    <span class="c1"># to replace or extend the default reset behavior.</span>

    <span class="n">commands</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">CommandTermCfg</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
    <span class="c1"># Command generators (e.g. velocity targets for locomotion).</span>
    <span class="c1"># Commands are resampled at configurable intervals and on reset.</span>

    <span class="n">curriculum</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">CurriculumTermCfg</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
    <span class="c1"># Curriculum terms that adjust training conditions based on performance.</span>

    <span class="n">metrics</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">MetricsTermCfg</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
    <span class="c1"># Custom metrics logged as episode averages alongside reward terms.</span>

    <span class="c1"># --- Misc ---</span>

    <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="c1"># Random seed for reproducibility. If None, a random seed is chosen</span>
    <span class="c1"># and stored back into this field after initialization.</span>

    <span class="n">viewer</span><span class="p">:</span> <span class="n">ViewerConfig</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">ViewerConfig</span><span class="p">)</span>
    <span class="c1"># Camera position, resolution, and tracking target for rendering.</span>
</pre></div>
</div>
</section>
<section id="term-configuration-pattern">
<span id="env-config-term-pattern"></span><h2>Term configuration pattern<a class="headerlink" href="#term-configuration-pattern" title="Link to this heading">#</a></h2>
<p>All manager dictionaries follow the same pattern. Each entry maps a string
name to a term configuration object. The configuration always carries at
minimum a <code class="docutils literal notranslate"><span class="pre">func</span></code> field pointing to the callable that implements the term,
and a <code class="docutils literal notranslate"><span class="pre">params</span></code> dict of extra keyword arguments forwarded to that callable.</p>
<p>The manager calls <code class="docutils literal notranslate"><span class="pre">func(env,</span> <span class="pre">**params)</span></code> each step (or <code class="docutils literal notranslate"><span class="pre">term(env,</span> <span class="pre">**params)</span></code>
when <code class="docutils literal notranslate"><span class="pre">func</span></code> is a class that has been instantiated). Term names are arbitrary;
they appear in training logs and are used only for identification.</p>
<p class="rubric">Reward terms</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">mjlab.envs</span><span class="w"> </span><span class="kn">import</span> <span class="n">mdp</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mjlab.managers.reward_manager</span><span class="w"> </span><span class="kn">import</span> <span class="n">RewardTermCfg</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mjlab.managers.scene_entity_config</span><span class="w"> </span><span class="kn">import</span> <span class="n">SceneEntityCfg</span>

<span class="n">rewards</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;alive&quot;</span><span class="p">:</span> <span class="n">RewardTermCfg</span><span class="p">(</span>
        <span class="n">func</span><span class="o">=</span><span class="n">mdp</span><span class="o">.</span><span class="n">is_alive</span><span class="p">,</span>
        <span class="n">weight</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="s2">&quot;joint_torques&quot;</span><span class="p">:</span> <span class="n">RewardTermCfg</span><span class="p">(</span>
        <span class="n">func</span><span class="o">=</span><span class="n">mdp</span><span class="o">.</span><span class="n">joint_torques_l2</span><span class="p">,</span>
        <span class="n">weight</span><span class="o">=-</span><span class="mf">1e-4</span><span class="p">,</span>
        <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;asset_cfg&quot;</span><span class="p">:</span> <span class="n">SceneEntityCfg</span><span class="p">(</span><span class="s2">&quot;robot&quot;</span><span class="p">)},</span>
    <span class="p">),</span>
    <span class="s2">&quot;action_rate&quot;</span><span class="p">:</span> <span class="n">RewardTermCfg</span><span class="p">(</span>
        <span class="n">func</span><span class="o">=</span><span class="n">mdp</span><span class="o">.</span><span class="n">action_rate_l2</span><span class="p">,</span>
        <span class="n">weight</span><span class="o">=-</span><span class="mf">0.1</span><span class="p">,</span>
    <span class="p">),</span>
<span class="p">}</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">weight</span></code> scales the function’s output before it is summed into the total
reward. Negative weights produce penalties.</p>
<p><code class="docutils literal notranslate"><span class="pre">params</span></code> maps to keyword arguments of the function. For example,
<code class="docutils literal notranslate"><span class="pre">mdp.joint_torques_l2(env,</span> <span class="pre">asset_cfg=...)</span></code> receives <code class="docutils literal notranslate"><span class="pre">asset_cfg</span></code> from the
<code class="docutils literal notranslate"><span class="pre">params</span></code> dict. Any argument not listed in <code class="docutils literal notranslate"><span class="pre">params</span></code> must have a default
value in the function signature.</p>
<p class="rubric">Termination terms</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">mjlab.envs</span><span class="w"> </span><span class="kn">import</span> <span class="n">mdp</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mjlab.managers.termination_manager</span><span class="w"> </span><span class="kn">import</span> <span class="n">TerminationTermCfg</span>

<span class="n">terminations</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;time_out&quot;</span><span class="p">:</span> <span class="n">TerminationTermCfg</span><span class="p">(</span>
        <span class="n">func</span><span class="o">=</span><span class="n">mdp</span><span class="o">.</span><span class="n">time_out</span><span class="p">,</span>
        <span class="n">time_out</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>   <span class="c1"># marks this as a truncation, not a failure</span>
    <span class="p">),</span>
    <span class="s2">&quot;fell_over&quot;</span><span class="p">:</span> <span class="n">TerminationTermCfg</span><span class="p">(</span>
        <span class="n">func</span><span class="o">=</span><span class="n">mdp</span><span class="o">.</span><span class="n">bad_orientation</span><span class="p">,</span>
        <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;limit_angle&quot;</span><span class="p">:</span> <span class="mf">1.22</span><span class="p">},</span>   <span class="c1"># ~70 degrees in radians</span>
    <span class="p">),</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">time_out</span></code> flag on <code class="docutils literal notranslate"><span class="pre">TerminationTermCfg</span></code> tells the manager to treat
this condition as a truncation rather than a terminal failure. Truncations
map to the <code class="docutils literal notranslate"><span class="pre">truncated</span></code> signal in the Gym interface; failures map to
<code class="docutils literal notranslate"><span class="pre">terminated</span></code>. This distinction matters for value bootstrapping in RL
algorithms.</p>
<p class="rubric">Event terms</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">mjlab.managers.event_manager</span><span class="w"> </span><span class="kn">import</span> <span class="n">EventTermCfg</span>

<span class="n">events</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;reset_base&quot;</span><span class="p">:</span> <span class="n">EventTermCfg</span><span class="p">(</span>
        <span class="n">func</span><span class="o">=</span><span class="n">mdp</span><span class="o">.</span><span class="n">reset_root_state_uniform</span><span class="p">,</span>
        <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;reset&quot;</span><span class="p">,</span>
        <span class="n">params</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;pose_range&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;yaw&quot;</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mf">3.14</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">)},</span>
            <span class="s2">&quot;velocity_range&quot;</span><span class="p">:</span> <span class="p">{},</span>
        <span class="p">},</span>
    <span class="p">),</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">mode</span></code> field on <code class="docutils literal notranslate"><span class="pre">EventTermCfg</span></code> controls when the term fires:
at startup, on episode reset, or at regular intervals. See <a class="reference internal" href="events.html#events"><span class="std std-ref">Events</span></a>
for the full treatment of lifecycle modes, built-in event functions, and
the relationship between events and domain randomization.</p>
<p class="rubric">Function-based vs. class-based terms</p>
<p>Terms can be plain functions or classes. Functions are suitable for stateless
computations; classes are useful when a term needs to cache expensive setup or
maintain state across steps.</p>
<p>A function-based term has the signature <code class="docutils literal notranslate"><span class="pre">func(env,</span> <span class="pre">**params)</span> <span class="pre">-&gt;</span> <span class="pre">Tensor</span></code>. A
class-based term is instantiated once with <code class="docutils literal notranslate"><span class="pre">(cfg,</span> <span class="pre">env)</span></code> and then called with
the same signature. Classes can optionally implement a <code class="docutils literal notranslate"><span class="pre">reset(env_ids)</span></code> hook
for per-episode state clearing.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Function-based (stateless)</span>
<span class="n">RewardTermCfg</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="n">mdp</span><span class="o">.</span><span class="n">joint_torques_l2</span><span class="p">,</span> <span class="n">weight</span><span class="o">=-</span><span class="mf">0.01</span><span class="p">)</span>

<span class="c1"># Class-based (caches joint indices at init)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">MyReward</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cfg</span><span class="p">,</span> <span class="n">env</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">joint_ids</span> <span class="o">=</span> <span class="n">resolve_joint_ids</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">env</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">env</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">compute_reward</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">joint_ids</span><span class="p">)</span>

<span class="n">RewardTermCfg</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="n">MyReward</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="timing-decimation-timestep-and-episode-length">
<span id="env-config-timing"></span><h2>Timing: decimation, timestep, and episode length<a class="headerlink" href="#timing-decimation-timestep-and-episode-length" title="Link to this heading">#</a></h2>
<p>Three parameters jointly determine the temporal structure of the environment.</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">sim.mujoco.timestep</span></code></dt><dd><p>The physics integration step in seconds. The default is 0.002 s (500 Hz).
This is one of the most important parameters in any environment: smaller
values produce more stable physics but slow down simulation. See the MuJoCo
<a class="reference external" href="https://mujoco.readthedocs.io/en/stable/modeling.html#performance-tuning">performance tuning</a>
guide for practical advice on choosing timesteps and solver settings.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">decimation</span></code></dt><dd><p>The number of physics steps executed per policy step. The policy runs at
<code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">/</span> <span class="pre">(timestep</span> <span class="pre">*</span> <span class="pre">decimation)</span></code> Hz.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">episode_length_s</span></code></dt><dd><p>The episode duration in seconds. The maximum number of policy steps per
episode is <code class="docutils literal notranslate"><span class="pre">ceil(episode_length_s</span> <span class="pre">/</span> <span class="pre">(timestep</span> <span class="pre">*</span> <span class="pre">decimation))</span></code>.</p>
</dd>
</dl>
<p><strong>Concrete example.</strong> The velocity task uses <code class="docutils literal notranslate"><span class="pre">timestep=0.005</span></code> (200 Hz
physics) and <code class="docutils literal notranslate"><span class="pre">decimation=4</span></code>, giving a policy frequency of 50 Hz. With
<code class="docutils literal notranslate"><span class="pre">episode_length_s=20.0</span></code>, each episode runs for exactly 1000 policy steps.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">physics_dt</span>  <span class="o">=</span> <span class="mf">0.005</span>        <span class="c1"># seconds per physics step (200 Hz)</span>
<span class="n">decimation</span>  <span class="o">=</span> <span class="mi">4</span>            <span class="c1"># physics steps per policy step</span>
<span class="n">step_dt</span>     <span class="o">=</span> <span class="mf">0.005</span> <span class="o">*</span> <span class="mi">4</span>   <span class="c1"># = 0.02 s per policy step (50 Hz)</span>
<span class="n">episode_len</span> <span class="o">=</span> <span class="mf">20.0</span> <span class="o">/</span> <span class="mf">0.02</span>  <span class="c1"># = 1000 policy steps per episode</span>
</pre></div>
</div>
<p>To read these values at runtime, use the environment properties:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">env</span><span class="o">.</span><span class="n">physics_dt</span>          <span class="c1"># = cfg.sim.mujoco.timestep</span>
<span class="n">env</span><span class="o">.</span><span class="n">step_dt</span>             <span class="c1"># = cfg.sim.mujoco.timestep * cfg.decimation</span>
<span class="n">env</span><span class="o">.</span><span class="n">max_episode_length</span>  <span class="c1"># steps (int)</span>
<span class="n">env</span><span class="o">.</span><span class="n">max_episode_length_s</span>  <span class="c1"># seconds (float)</span>
</pre></div>
</div>
<p>When <code class="docutils literal notranslate"><span class="pre">scale_rewards_by_dt=True</span></code> (the default), each reward term is
multiplied by <code class="docutils literal notranslate"><span class="pre">step_dt</span></code> before being returned. A reward function that
returns a constant value of 1.0 contributes <code class="docutils literal notranslate"><span class="pre">step_dt</span></code> per step and
approximately <code class="docutils literal notranslate"><span class="pre">episode_length_s</span></code> over a full episode, regardless of how
<code class="docutils literal notranslate"><span class="pre">decimation</span></code> and <code class="docutils literal notranslate"><span class="pre">timestep</span></code> are set. Changing the simulation frequency
without disabling this scaling leaves reward magnitudes unchanged.</p>
</section>
<section id="subclassing-pattern">
<span id="env-config-subclassing"></span><h2>Subclassing pattern<a class="headerlink" href="#subclassing-pattern" title="Link to this heading">#</a></h2>
<p>mjlab uses plain dataclass inheritance rather than deeply nested class
hierarchies. To build a task-specific configuration, subclass
<code class="docutils literal notranslate"><span class="pre">ManagerBasedRlEnvCfg</span></code> and override fields.</p>
<p>The recommended approach is to define the full configuration in a factory
function, then call it from robot-specific configs that override only the
fields that differ. The velocity task uses this pattern: <code class="docutils literal notranslate"><span class="pre">make_velocity_env_cfg</span></code>
returns a fully assembled <code class="docutils literal notranslate"><span class="pre">ManagerBasedRlEnvCfg</span></code>, and each robot
configuration calls the factory and patches in robot-specific values such
as the scene, joint name patterns, and action scale.</p>
<p>A condensed version of the factory illustrates the full assembly pattern:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">math</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">replace</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">mjlab.envs</span><span class="w"> </span><span class="kn">import</span> <span class="n">ManagerBasedRlEnvCfg</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mjlab.envs.mdp</span><span class="w"> </span><span class="kn">import</span> <span class="n">dr</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mjlab.envs.mdp.actions</span><span class="w"> </span><span class="kn">import</span> <span class="n">JointPositionActionCfg</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mjlab.managers.event_manager</span><span class="w"> </span><span class="kn">import</span> <span class="n">EventTermCfg</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mjlab.managers.observation_manager</span><span class="w"> </span><span class="kn">import</span> <span class="n">ObservationGroupCfg</span><span class="p">,</span> <span class="n">ObservationTermCfg</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mjlab.managers.reward_manager</span><span class="w"> </span><span class="kn">import</span> <span class="n">RewardTermCfg</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mjlab.managers.scene_entity_config</span><span class="w"> </span><span class="kn">import</span> <span class="n">SceneEntityCfg</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mjlab.managers.termination_manager</span><span class="w"> </span><span class="kn">import</span> <span class="n">TerminationTermCfg</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mjlab.scene</span><span class="w"> </span><span class="kn">import</span> <span class="n">SceneCfg</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mjlab.sim</span><span class="w"> </span><span class="kn">import</span> <span class="n">MujocoCfg</span><span class="p">,</span> <span class="n">SimulationCfg</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mjlab.tasks.velocity</span><span class="w"> </span><span class="kn">import</span> <span class="n">mdp</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mjlab.tasks.velocity.mdp</span><span class="w"> </span><span class="kn">import</span> <span class="n">UniformVelocityCommandCfg</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mjlab.terrains</span><span class="w"> </span><span class="kn">import</span> <span class="n">TerrainEntityCfg</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mjlab.terrains.config</span><span class="w"> </span><span class="kn">import</span> <span class="n">ROUGH_TERRAINS_CFG</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mjlab.viewer</span><span class="w"> </span><span class="kn">import</span> <span class="n">ViewerConfig</span>


<span class="k">def</span><span class="w"> </span><span class="nf">make_velocity_env_cfg</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">ManagerBasedRlEnvCfg</span><span class="p">:</span>

    <span class="n">observations</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;actor&quot;</span><span class="p">:</span> <span class="n">ObservationGroupCfg</span><span class="p">(</span>
            <span class="n">terms</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;base_lin_vel&quot;</span><span class="p">:</span> <span class="n">ObservationTermCfg</span><span class="p">(</span>
                    <span class="n">func</span><span class="o">=</span><span class="n">mdp</span><span class="o">.</span><span class="n">builtin_sensor</span><span class="p">,</span>
                    <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;sensor_name&quot;</span><span class="p">:</span> <span class="s2">&quot;robot/imu_lin_vel&quot;</span><span class="p">},</span>
                <span class="p">),</span>
                <span class="s2">&quot;joint_pos&quot;</span><span class="p">:</span> <span class="n">ObservationTermCfg</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="n">mdp</span><span class="o">.</span><span class="n">joint_pos_rel</span><span class="p">),</span>
                <span class="s2">&quot;command&quot;</span><span class="p">:</span> <span class="n">ObservationTermCfg</span><span class="p">(</span>
                    <span class="n">func</span><span class="o">=</span><span class="n">mdp</span><span class="o">.</span><span class="n">generated_commands</span><span class="p">,</span>
                    <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;command_name&quot;</span><span class="p">:</span> <span class="s2">&quot;twist&quot;</span><span class="p">},</span>
                <span class="p">),</span>
                <span class="c1"># additional terms omitted for brevity</span>
            <span class="p">},</span>
            <span class="n">concatenate_terms</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">enable_corruption</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="s2">&quot;critic&quot;</span><span class="p">:</span> <span class="n">ObservationGroupCfg</span><span class="p">(</span>
            <span class="n">terms</span><span class="o">=</span><span class="p">{</span><span class="o">...</span><span class="p">},</span>
            <span class="n">concatenate_terms</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">enable_corruption</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">}</span>

    <span class="n">actions</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;joint_pos&quot;</span><span class="p">:</span> <span class="n">JointPositionActionCfg</span><span class="p">(</span>
            <span class="n">entity_name</span><span class="o">=</span><span class="s2">&quot;robot&quot;</span><span class="p">,</span>
            <span class="n">actuator_names</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;.*&quot;</span><span class="p">,),</span>
            <span class="n">scale</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">use_default_offset</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">}</span>

    <span class="n">commands</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;twist&quot;</span><span class="p">:</span> <span class="n">UniformVelocityCommandCfg</span><span class="p">(</span>
            <span class="n">entity_name</span><span class="o">=</span><span class="s2">&quot;robot&quot;</span><span class="p">,</span>
            <span class="n">resampling_time_range</span><span class="o">=</span><span class="p">(</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">),</span>
            <span class="n">ranges</span><span class="o">=</span><span class="n">UniformVelocityCommandCfg</span><span class="o">.</span><span class="n">Ranges</span><span class="p">(</span>
                <span class="n">lin_vel_x</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                <span class="n">lin_vel_y</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                <span class="n">ang_vel_z</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
                <span class="n">heading</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span>
            <span class="p">),</span>
        <span class="p">)</span>
    <span class="p">}</span>

    <span class="n">events</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;reset_base&quot;</span><span class="p">:</span> <span class="n">EventTermCfg</span><span class="p">(</span>
            <span class="n">func</span><span class="o">=</span><span class="n">mdp</span><span class="o">.</span><span class="n">reset_root_state_uniform</span><span class="p">,</span>
            <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;reset&quot;</span><span class="p">,</span>
            <span class="n">params</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;pose_range&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="s2">&quot;yaw&quot;</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mf">3.14</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">)},</span>
                <span class="s2">&quot;velocity_range&quot;</span><span class="p">:</span> <span class="p">{},</span>
            <span class="p">},</span>
        <span class="p">),</span>
        <span class="s2">&quot;foot_friction&quot;</span><span class="p">:</span> <span class="n">EventTermCfg</span><span class="p">(</span>
            <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;startup&quot;</span><span class="p">,</span>
            <span class="n">func</span><span class="o">=</span><span class="n">dr</span><span class="o">.</span><span class="n">geom_friction</span><span class="p">,</span>
            <span class="n">params</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;asset_cfg&quot;</span><span class="p">:</span> <span class="n">SceneEntityCfg</span><span class="p">(</span><span class="s2">&quot;robot&quot;</span><span class="p">,</span> <span class="n">geom_names</span><span class="o">=</span><span class="p">[]),</span>
                <span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="s2">&quot;abs&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ranges&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">),</span>
            <span class="p">},</span>
        <span class="p">),</span>
        <span class="s2">&quot;push_robot&quot;</span><span class="p">:</span> <span class="n">EventTermCfg</span><span class="p">(</span>
            <span class="n">func</span><span class="o">=</span><span class="n">mdp</span><span class="o">.</span><span class="n">push_by_setting_velocity</span><span class="p">,</span>
            <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;interval&quot;</span><span class="p">,</span>
            <span class="n">interval_range_s</span><span class="o">=</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">),</span>
            <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;velocity_range&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)}},</span>
        <span class="p">),</span>
    <span class="p">}</span>

    <span class="n">rewards</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;track_linear_velocity&quot;</span><span class="p">:</span> <span class="n">RewardTermCfg</span><span class="p">(</span>
            <span class="n">func</span><span class="o">=</span><span class="n">mdp</span><span class="o">.</span><span class="n">track_linear_velocity</span><span class="p">,</span>
            <span class="n">weight</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span>
            <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;command_name&quot;</span><span class="p">:</span> <span class="s2">&quot;twist&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">:</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)},</span>
        <span class="p">),</span>
        <span class="s2">&quot;dof_pos_limits&quot;</span><span class="p">:</span> <span class="n">RewardTermCfg</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="n">mdp</span><span class="o">.</span><span class="n">joint_pos_limits</span><span class="p">,</span> <span class="n">weight</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">),</span>
        <span class="s2">&quot;action_rate_l2&quot;</span><span class="p">:</span> <span class="n">RewardTermCfg</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="n">mdp</span><span class="o">.</span><span class="n">action_rate_l2</span><span class="p">,</span> <span class="n">weight</span><span class="o">=-</span><span class="mf">0.1</span><span class="p">),</span>
    <span class="p">}</span>

    <span class="n">terminations</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;time_out&quot;</span><span class="p">:</span> <span class="n">TerminationTermCfg</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="n">mdp</span><span class="o">.</span><span class="n">time_out</span><span class="p">,</span> <span class="n">time_out</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
        <span class="s2">&quot;fell_over&quot;</span><span class="p">:</span> <span class="n">TerminationTermCfg</span><span class="p">(</span>
            <span class="n">func</span><span class="o">=</span><span class="n">mdp</span><span class="o">.</span><span class="n">bad_orientation</span><span class="p">,</span>
            <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;limit_angle&quot;</span><span class="p">:</span> <span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mf">70.0</span><span class="p">)},</span>
        <span class="p">),</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">ManagerBasedRlEnvCfg</span><span class="p">(</span>
        <span class="n">decimation</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
        <span class="n">episode_length_s</span><span class="o">=</span><span class="mf">20.0</span><span class="p">,</span>
        <span class="n">sim</span><span class="o">=</span><span class="n">SimulationCfg</span><span class="p">(</span>
            <span class="n">nconmax</span><span class="o">=</span><span class="mi">35</span><span class="p">,</span>
            <span class="n">njmax</span><span class="o">=</span><span class="mi">1500</span><span class="p">,</span>
            <span class="n">mujoco</span><span class="o">=</span><span class="n">MujocoCfg</span><span class="p">(</span><span class="n">timestep</span><span class="o">=</span><span class="mf">0.005</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ls_iterations</span><span class="o">=</span><span class="mi">20</span><span class="p">),</span>
        <span class="p">),</span>
        <span class="n">scene</span><span class="o">=</span><span class="n">SceneCfg</span><span class="p">(</span>
            <span class="n">terrain</span><span class="o">=</span><span class="n">TerrainEntityCfg</span><span class="p">(</span>
                <span class="n">terrain_type</span><span class="o">=</span><span class="s2">&quot;generator&quot;</span><span class="p">,</span>
                <span class="n">terrain_generator</span><span class="o">=</span><span class="n">replace</span><span class="p">(</span><span class="n">ROUGH_TERRAINS_CFG</span><span class="p">),</span>
                <span class="n">max_init_terrain_level</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="n">num_envs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">observations</span><span class="o">=</span><span class="n">observations</span><span class="p">,</span>
        <span class="n">actions</span><span class="o">=</span><span class="n">actions</span><span class="p">,</span>
        <span class="n">commands</span><span class="o">=</span><span class="n">commands</span><span class="p">,</span>
        <span class="n">events</span><span class="o">=</span><span class="n">events</span><span class="p">,</span>
        <span class="n">rewards</span><span class="o">=</span><span class="n">rewards</span><span class="p">,</span>
        <span class="n">terminations</span><span class="o">=</span><span class="n">terminations</span><span class="p">,</span>
    <span class="p">)</span>
</pre></div>
</div>
<p>Robot-specific configs call this factory and patch fields using
<code class="docutils literal notranslate"><span class="pre">dataclasses.replace</span></code> or direct assignment. Common per-robot overrides
include <code class="docutils literal notranslate"><span class="pre">scene</span></code> (to add the robot entity and sensors), joint name patterns
inside <code class="docutils literal notranslate"><span class="pre">SceneEntityCfg</span></code>, action <code class="docutils literal notranslate"><span class="pre">scale</span></code>, and body names for reward terms.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Isaac Lab uses deeply nested <code class="docutils literal notranslate"><span class="pre">__post_init__</span></code> overrides for configuration
inheritance. mjlab avoids that pattern: each <code class="docutils literal notranslate"><span class="pre">ManagerBasedRlEnvCfg</span></code> is a
flat, inspectable dataclass. A misspelled field name raises a <code class="docutils literal notranslate"><span class="pre">TypeError</span></code>
at construction rather than silently creating a new attribute. See
<a class="reference internal" href="migration_isaac_lab.html#migration-isaac-lab"><span class="std std-ref">Migrating from Isaac Lab</span></a> for a full comparison.</p>
</div>
</section>
<section id="where-to-go-next">
<h2>Where to go next<a class="headerlink" href="#where-to-go-next" title="Link to this heading">#</a></h2>
<p>The remaining pages in the Manager Layer section cover each manager in
detail:</p>
<ul class="simple">
<li><p><a class="reference internal" href="observations.html#observations"><span class="std std-ref">Observations</span></a>: observation groups, the processing pipeline
(clip, scale, noise, delay, history), and built-in observation functions.</p></li>
<li><p><a class="reference internal" href="actions.html#actions"><span class="std std-ref">Actions</span></a>: action types and how the action manager routes policy
output to actuators.</p></li>
<li><p><a class="reference internal" href="rewards.html#rewards"><span class="std std-ref">Rewards</span></a>: reward terms and scaling by dt.</p></li>
<li><p><a class="reference internal" href="terminations.html#terminations"><span class="std std-ref">Terminations</span></a>: episode end conditions and the truncation/failure
distinction.</p></li>
<li><p><a class="reference internal" href="commands.html#commands"><span class="std std-ref">Commands</span></a>: command generators and goal-conditioned task setup.</p></li>
<li><p><a class="reference internal" href="events.html#events"><span class="std std-ref">Events</span></a>: the event manager lifecycle (startup, reset, interval).</p></li>
<li><p><a class="reference internal" href="randomization.html#domain-randomization"><span class="std std-ref">Domain Randomization</span></a>: the full <code class="docutils literal notranslate"><span class="pre">dr</span></code> module for domain
randomization.</p></li>
<li><p><a class="reference internal" href="curriculum.html#curriculum"><span class="std std-ref">Curriculum</span></a>: difficulty progression based on policy performance.</p></li>
<li><p><a class="reference internal" href="metrics.html#metrics"><span class="std std-ref">Metrics</span></a>: custom per-step metrics logged as episode averages.</p></li>
</ul>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="terrain.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Terrain</p>
      </div>
    </a>
    <a class="right-next"
       href="observations.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Observations</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#annotated-skeleton">Annotated skeleton</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#term-configuration-pattern">Term configuration pattern</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#timing-decimation-timestep-and-episode-length">Timing: decimation, timestep, and episode length</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#subclassing-pattern">Subclassing pattern</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#where-to-go-next">Where to go next</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The mjlab Developers
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025, The mjlab Developers.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    <p class="last-updated">
  Last updated on Feb 25, 2026.
  <br/>
</p>
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>