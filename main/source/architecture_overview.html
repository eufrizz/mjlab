
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Architecture Overview &#8212; mjlab Documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/twemoji.css" />
    <link rel="stylesheet" type="text/css" href="/home/runner/work/mjlab/mjlab/.venv/lib/python3.13/site-packages/sphinxcontrib/icon/node_modules/@fortawesome/fontawesome-free/css/all.min.css?v=53359634" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=3ea80bc3" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="https://unpkg.com/twemoji@latest/dist/twemoji.min.js"></script>
    <script src="../_static/twemoji.js"></script>
    <script src="/home/runner/work/mjlab/mjlab/.venv/lib/python3.13/site-packages/sphinxcontrib/icon/node_modules/@fortawesome/fontawesome-free/js/all.min.js?v=ec35c6c9"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'source/architecture_overview';</script>
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Entity" href="entity/index.html" />
    <link rel="prev" title="Contributing" href="contributing.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
    <meta name="docbuild:last-update" content="Feb 25, 2026"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">mjlab Documentation</p>
  
</a></div>
        <div class="sidebar-primary-item">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
        <div class="sidebar-primary-item">
<div class="sidebar-version-switcher">
  <label class="sidebar-version-label" for="version-select">Version</label>
  <select id="version-select" class="sidebar-version-select" onchange="location = this.value;">
    <option value="architecture_overview.html" selected>main</option>
  </select>
</div>
</div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Concepts</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Architecture Overview</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="entity/index.html">Entity</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="entity/entity_data.html">Entity Data</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="actuators.html">Actuators</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="sensors/index.html">Sensors</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="sensors/raycast_sensor.html">RayCast Sensor</a></li>
<li class="toctree-l2"><a class="reference internal" href="sensors/rgbd_camera.html">RGB-D Camera</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="scene.html">Scene</a></li>
<li class="toctree-l1"><a class="reference internal" href="terrain.html">Terrain</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">The Manager Layer</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="environment_config.html">Environment Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="observations.html">Observations</a></li>
<li class="toctree-l1"><a class="reference internal" href="actions.html">Actions</a></li>
<li class="toctree-l1"><a class="reference internal" href="rewards.html">Rewards</a></li>
<li class="toctree-l1"><a class="reference internal" href="terminations.html">Terminations</a></li>
<li class="toctree-l1"><a class="reference internal" href="commands.html">Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="events.html">Events</a></li>
<li class="toctree-l1"><a class="reference internal" href="randomization.html">Domain Randomization</a></li>
<li class="toctree-l1"><a class="reference internal" href="curriculum.html">Curriculum</a></li>
<li class="toctree-l1"><a class="reference internal" href="metrics.html">Metrics</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Training &amp; Debugging</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="training/rsl_rl.html">Training with RSL-RL</a></li>
<li class="toctree-l1"><a class="reference internal" href="viewers.html">Viewers</a></li>
<li class="toctree-l1"><a class="reference internal" href="training/distributed_training.html">Distributed Training</a></li>
<li class="toctree-l1"><a class="reference internal" href="training/cloud.html">Cloud Training</a></li>
<li class="toctree-l1"><a class="reference internal" href="debugging/nan_guard.html">NaN Guard</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="api/index.html">API Reference</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="api/envs.html">mjlab.envs</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/scene.html">mjlab.scene</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/sim.html">mjlab.sim</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/entity.html">mjlab.entity</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/actuator.html">mjlab.actuator</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/sensor.html">mjlab.sensor</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/managers.html">mjlab.managers</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/terrains.html">mjlab.terrains</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/rl.html">mjlab.rl</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/viewer.html">mjlab.viewer</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/tasks.html">mjlab.tasks</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Further Reading</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="motivation.html">Why mjlab?</a></li>
<li class="toctree-l1"><a class="reference internal" href="migration_isaac_lab.html">Migrating from Isaac Lab</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ &amp; Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/mujocolab/mjlab" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/mujocolab/mjlab/edit/main/docs/source/architecture_overview.rst" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/mujocolab/mjlab/issues/new?title=Issue%20on%20page%20%2Fsource/architecture_overview.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/source/architecture_overview.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Architecture Overview</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-simulation-layer">The simulation layer</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-manager-layer">The manager layer</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-environment-lifecycle">The environment lifecycle</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="architecture-overview">
<span id="id1"></span><h1>Architecture Overview<a class="headerlink" href="#architecture-overview" title="Link to this heading">#</a></h1>
<p>mjlab is organized into two layers: a <strong>simulation layer</strong> that models
the robot and world, and a <strong>manager layer</strong> that defines the
reinforcement learning problem on top of it. Understanding this separation
is the fastest way to build a mental map of the system.</p>
<figure class="align-center" id="id2">
<a class="reference internal image-reference" href="../_images/architecture_diagram.png"><img alt="mjlab architecture diagram" src="../_images/architecture_diagram.png" style="width: 60%;" />
</a>
<figcaption>
<p><span class="caption-text">Entities are composed into an MjSpec, compiled, and transferred to
MuJoCo Warp for GPU simulation. The ManagerBasedRlEnv orchestrates the
MDP; RSL-RL handles training.</span><a class="headerlink" href="#id2" title="Link to this image">#</a></p>
</figcaption>
</figure>
<section id="the-simulation-layer">
<h2>The simulation layer<a class="headerlink" href="#the-simulation-layer" title="Link to this heading">#</a></h2>
<p><strong>Scene pipeline.</strong>
mjlab constructs scenes by composing entity descriptions into a single
<a class="reference external" href="https://mujoco.readthedocs.io/en/stable/programming/modeledit.html">MjSpec</a>.
Each entity starts from an
<a class="reference external" href="https://mujoco.readthedocs.io/en/latest/modeling.html">MJCF</a> file
loaded via <code class="docutils literal notranslate"><span class="pre">MjSpec.from_file()</span></code>. Users who define everything in XML can
use this directly. For more control, Python dataclasses can extend or
override properties on the loaded spec: actuators, collision rules,
materials, sensors, and initial state. This hybrid approach lets users
start from existing MuJoCo models and layer on task-specific configuration
without modifying the original XML. The composed specification is compiled
into an <code class="docutils literal notranslate"><span class="pre">MjModel</span></code> on the CPU, then transferred to the GPU via
<a class="reference external" href="https://mujoco.readthedocs.io/en/stable/mjwarp/index.html">MuJoCo Warp</a>,
which is built on <a class="reference external" href="https://nvidia.github.io/warp/">NVIDIA Warp</a>.</p>
<p><strong>MuJoCo Warp.</strong>
MuJoCo Warp is a GPU-accelerated backend for MuJoCo. It preserves
MuJoCo’s <code class="docutils literal notranslate"><span class="pre">MjModel</span></code>/<code class="docutils literal notranslate"><span class="pre">MjData</span></code> paradigm but adds a leading <em>world</em>
dimension: a single <code class="docutils literal notranslate"><span class="pre">MjData</span></code> object holds the state of N independent
simulation instances in parallel, enabling thousands of environments to
be stepped simultaneously. Model parameters are shared across all worlds
by default, and individual fields can be expanded to vary per-world when
domain randomization requires it. mjlab captures the simulation step as a
<a class="reference external" href="https://developer.nvidia.com/blog/cuda-graphs">CUDA graph</a>: the kernel
execution sequence is recorded once and replayed on subsequent calls,
eliminating CPU-side dispatch overhead.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>CUDA graph capture is a one-time cost at environment startup. Per-episode
resets and domain randomization events run as regular Python between graph
replays and do not break the capture.</p>
</div>
<p><strong>Components.</strong>
The simulation layer provides four core components, each with its own
documentation page:</p>
<ul class="simple">
<li><p><a class="reference internal" href="entity/index.html#entity"><span class="std std-ref">Entity</span></a>: a robot, a manipulated object, or a static object such
as <a class="reference internal" href="terrain.html#terrain"><span class="std std-ref">terrain</span></a>, defined by an MJCF description plus
optional Python configuration for actuators, collision rules, and
initial state.</p></li>
<li><p><a class="reference internal" href="actuators.html#actuators"><span class="std std-ref">Actuators</span></a>: how entities are controlled. Users can wrap actuators
already defined in MJCF or create new ones from Python configuration.</p></li>
<li><p><a class="reference internal" href="sensors/index.html#sensors"><span class="std std-ref">Sensors</span></a>: how the world is observed. Includes MuJoCo-native
sensors as well as custom sensors like RGB-D cameras and raycasters.</p></li>
<li><p><a class="reference internal" href="scene.html#scene"><span class="std std-ref">Scene</span></a>: scene composition and environment placement.</p></li>
</ul>
</section>
<section id="the-manager-layer">
<h2>The manager layer<a class="headerlink" href="#the-manager-layer" title="Link to this heading">#</a></h2>
<p>On top of the simulation layer, mjlab adopts the manager-based environment
design introduced by Isaac Lab. Users define their environment by composing
small, self-contained <em>terms</em> (reward functions, observation computations,
domain randomization events) and register them with the appropriate manager.
Each manager handles the lifecycle of its terms: calling them at the right
point in the simulation loop, aggregating their outputs, and exposing
diagnostics.</p>
<p>Terms can be plain functions for stateless computations, or classes that
inherit from <code class="docutils literal notranslate"><span class="pre">ManagerTermBase</span></code> when they need to cache expensive setup
(such as resolving regex patterns to joint indices at initialization) or
maintain per-episode state through a <code class="docutils literal notranslate"><span class="pre">reset()</span></code> hook.</p>
<p>Environments are configured through <code class="docutils literal notranslate"><span class="pre">ManagerBasedRlEnvCfg</span></code>, a plain
dataclass that holds term configuration dictionaries for each manager.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">mjlab.envs</span><span class="w"> </span><span class="kn">import</span> <span class="n">ManagerBasedRlEnvCfg</span>

<span class="n">cfg</span> <span class="o">=</span> <span class="n">ManagerBasedRlEnvCfg</span><span class="p">(</span>
    <span class="n">decimation</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>           <span class="c1"># 4 physics steps per policy step</span>
    <span class="n">episode_length_s</span><span class="o">=</span><span class="mf">20.0</span><span class="p">,</span>
    <span class="n">scene</span><span class="o">=...</span><span class="p">,</span>              <span class="c1"># SceneCfg: terrain, entities, sensors</span>
    <span class="n">sim</span><span class="o">=...</span><span class="p">,</span>                <span class="c1"># SimulationCfg: timestep, solver, integrator</span>
    <span class="n">observations</span><span class="o">=</span><span class="p">{</span><span class="o">...</span><span class="p">},</span>     <span class="c1"># ObservationManager terms</span>
    <span class="n">actions</span><span class="o">=</span><span class="p">{</span><span class="o">...</span><span class="p">},</span>          <span class="c1"># ActionManager terms</span>
    <span class="n">rewards</span><span class="o">=</span><span class="p">{</span><span class="o">...</span><span class="p">},</span>          <span class="c1"># RewardManager terms</span>
    <span class="n">terminations</span><span class="o">=</span><span class="p">{</span><span class="o">...</span><span class="p">},</span>     <span class="c1"># TerminationManager terms</span>
    <span class="n">events</span><span class="o">=</span><span class="p">{</span><span class="o">...</span><span class="p">},</span>           <span class="c1"># EventManager terms (resets, DR)</span>
    <span class="n">commands</span><span class="o">=</span><span class="p">{</span><span class="o">...</span><span class="p">},</span>         <span class="c1"># CommandManager terms (velocity targets, etc.)</span>
    <span class="n">curriculum</span><span class="o">=</span><span class="p">{</span><span class="o">...</span><span class="p">},</span>       <span class="c1"># CurriculumManager terms</span>
    <span class="n">metrics</span><span class="o">=</span><span class="p">{</span><span class="o">...</span><span class="p">},</span>          <span class="c1"># MetricsManager terms</span>
<span class="p">)</span>
</pre></div>
</div>
<p class="rubric">The eight managers</p>
<ul class="simple">
<li><p><strong>ObservationManager</strong>: assembles observation groups with configurable
processing (clipping, noise, delay, history). Supports asymmetric
actor-critic. See <a class="reference internal" href="observations.html#observations"><span class="std std-ref">Observations</span></a>.</p></li>
<li><p><strong>ActionManager</strong>: routes the policy’s output tensor to entity actuators,
handling scaling and offset. See <a class="reference internal" href="actions.html#actions"><span class="std std-ref">Actions</span></a>.</p></li>
<li><p><strong>RewardManager</strong>: computes a weighted sum of reward terms, scaled by step
duration for frequency invariance. See <a class="reference internal" href="rewards.html#rewards"><span class="std std-ref">Rewards</span></a>.</p></li>
<li><p><strong>TerminationManager</strong>: evaluates stop conditions, distinguishing terminal
resets from timeouts. See <a class="reference internal" href="terminations.html#terminations"><span class="std std-ref">Terminations</span></a>.</p></li>
<li><p><strong>EventManager</strong>: fires terms at lifecycle points (startup, reset,
interval). Domain randomization is implemented through event terms.
See <a class="reference internal" href="events.html#events"><span class="std std-ref">Events</span></a> and <a class="reference internal" href="randomization.html#domain-randomization"><span class="std std-ref">Domain Randomization</span></a>.</p></li>
<li><p><strong>CommandManager</strong>: generates and resamples goal signals (velocity
targets, pose targets). See <a class="reference internal" href="commands.html#commands"><span class="std std-ref">Commands</span></a>.</p></li>
<li><p><strong>CurriculumManager</strong>: adjusts training conditions based on policy
performance. See <a class="reference internal" href="curriculum.html#curriculum"><span class="std std-ref">Curriculum</span></a>.</p></li>
<li><p><strong>MetricsManager</strong>: logs custom per-step values as episode averages.
See <a class="reference internal" href="metrics.html#metrics"><span class="std std-ref">Metrics</span></a>.</p></li>
</ul>
<p>For the full configuration reference covering all managers, see
<a class="reference internal" href="environment_config.html#environment-config"><span class="std std-ref">Environment Configuration</span></a>.</p>
</section>
<section id="the-environment-lifecycle">
<h2>The environment lifecycle<a class="headerlink" href="#the-environment-lifecycle" title="Link to this heading">#</a></h2>
<p>Each environment instance passes through four phases.</p>
<ol class="arabic simple">
<li><p><strong>Build.</strong> <code class="docutils literal notranslate"><span class="pre">Scene</span></code> composes entity MJCF files via <code class="docutils literal notranslate"><span class="pre">MjSpec</span></code> and
compiles <code class="docutils literal notranslate"><span class="pre">MjModel</span></code> on the CPU. <code class="docutils literal notranslate"><span class="pre">Simulation</span></code> uploads the model to the
GPU via MuJoCo Warp, allocating a single <code class="docutils literal notranslate"><span class="pre">MjData</span></code> with N parallel
worlds. CUDA graphs for <code class="docutils literal notranslate"><span class="pre">step</span></code>, <code class="docutils literal notranslate"><span class="pre">forward</span></code>, <code class="docutils literal notranslate"><span class="pre">reset</span></code>, and <code class="docutils literal notranslate"><span class="pre">sense</span></code>
are captured.</p></li>
<li><p><strong>Initialize.</strong> Managers are constructed from the term configuration
dictionaries. Regex patterns are matched to joint, body, and geom
indices. Observation history and delay buffers are allocated. Model
fields required by domain randomization terms are expanded from shared
to per-world storage, and CUDA graphs are rebuilt to reflect the new
layout. Startup events are fired once.</p></li>
<li><p><strong>Reset.</strong> Called at the start of training and whenever an environment
terminates or times out. The <code class="docutils literal notranslate"><span class="pre">EventManager</span></code> fires <code class="docutils literal notranslate"><span class="pre">reset</span></code> terms,
which return the scene to an initial state with optional randomization.
Command targets are resampled. Observation history buffers are cleared.</p></li>
<li><p><strong>Step.</strong> The policy action is processed by the <code class="docutils literal notranslate"><span class="pre">ActionManager</span></code>. The
physics simulation advances <code class="docutils literal notranslate"><span class="pre">decimation</span></code> times, with actuator commands
applied and entity state updated each sub-step. After the decimation
loop, the <code class="docutils literal notranslate"><span class="pre">TerminationManager</span></code> checks stop conditions, the
<code class="docutils literal notranslate"><span class="pre">RewardManager</span></code> computes the reward signal, and any terminated
environments are reset. A single <code class="docutils literal notranslate"><span class="pre">forward()</span></code> call refreshes derived
quantities for all environments. The <code class="docutils literal notranslate"><span class="pre">CommandManager</span></code> advances or
resamples goals. Interval events fire if scheduled. Sensors update. The
<code class="docutils literal notranslate"><span class="pre">ObservationManager</span></code> assembles the observation for the next policy
query.</p></li>
</ol>
<p>The step sequence in order:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>action_manager.process_action(action)
for _ in range(decimation):
    action_manager.apply_action()
    sim.step()
    scene.update()
termination_manager.compute()
reward_manager.compute()
metrics_manager.compute()
[reset terminated envs]
sim.forward()
command_manager.compute()
event_manager.apply(mode=&quot;interval&quot;)
sim.sense()
observation_manager.compute()
</pre></div>
</div>
<p>With this mental model in place, the Concepts pages cover each simulation
layer component in detail, and The Manager Layer pages walk through each
manager’s configuration and built-in terms. If you are coming from Isaac
Lab, <a class="reference internal" href="migration_isaac_lab.html#migration-isaac-lab"><span class="std std-ref">Migrating from Isaac Lab</span></a> describes the key API differences.</p>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="contributing.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Contributing</p>
      </div>
    </a>
    <a class="right-next"
       href="entity/index.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Entity</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-simulation-layer">The simulation layer</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-manager-layer">The manager layer</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-environment-lifecycle">The environment lifecycle</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The mjlab Developers
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025, The mjlab Developers.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    <p class="last-updated">
  Last updated on Feb 25, 2026.
  <br/>
</p>
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>